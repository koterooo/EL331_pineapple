<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>KWIC Web App</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
  <div class="container"><!-- ✨ 追加 -->
    <h1>KWIC Web App</h1>

    <form method="post">
      <label>Text:<br>
        <textarea name="text" rows="10"
          placeholder="Enter your text here..." required>{{ request.form.get('text','') }}</textarea>
      </label>

      <label>Target:<br>
        <input type="text" name="target" value="{{ request.form.get('target','') }}" required>
      </label>

      <label>Window size:
        <input type="number" name="window" value="{{ request.form.get('window',5) }}" min="1" max="20">
      </label>

      <label>Search type:
        <select name="search_type">
          {% for opt in ['token','pos','entity'] %}
            <option value="{{ opt }}" {% if request.form.get('search_type')==opt %}selected{% endif %}>
              {{ opt|capitalize }}
            </option>
          {% endfor %}
        </select>
      </label>

      <label>Sort mode:
        <select name="sort_mode">
          {% for opt,label in [('sequential','Sequential'),
                               ('token_freq','Token Freq'),
                               ('pos_freq','POS Freq')] %}
            <option value="{{ opt }}" {% if request.form.get('sort_mode')==opt %}selected{% endif %}>
              {{ label }}
            </option>
          {% endfor %}
        </select>
      </label>

      <button type="submit">Search</button>
    </form>

    {% if result %}
      <h2>KWIC Results</h2>
      <div class="table-wrapper"><!-- ✨ 追加：横スクロール用 -->
        <table>
          <thead>
            <tr><th>Left</th><th>Keyword</th><th>Right</th></tr>
          </thead>
          <tbody>
            {% for item in result %}
              <tr>
                <td class="left">{{ item.left }}</td>
                <td class="mid">{{ item.mid }}</td>
                <td class="right">{{ item.right }}</td>
              </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
    {% endif %}

    {% if patterns %}
      <h3>Most-frequent next-token patterns</h3>
      <ul>
        {% for pat, cnt in patterns %}
          <li>{{ pat }} – {{ cnt }}</li>
        {% endfor %}
      </ul>
    {% endif %}
  </div><!-- /container -->
</body>
</html>